<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Recepci√≥n de Veh√≠culos - CDA Barrancabermeja</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 10px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        /* Header Mejorado */
        .header-table {
            width: 100%;
            border-collapse: collapse;
            background: linear-gradient(135deg, #0033A0 0%, #0055CC 100%);
        }

        .header-table td {
            border: none;
            padding: 20px;
            vertical-align: middle;
        }

        .logo-cell {
            width: 140px;
            text-align: center;
        }

        .logo-container {
            background: white;
            border-radius: 50%;
            padding: 15px;
            display: inline-block;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .logo-img {
            max-width: 100px;
            height: auto;
        }

        .title-cell {
            text-align: center;
        }

        .title-cell h1 {
            font-size: 22px;
            font-weight: bold;
            color: white;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .title-cell h2 {
            font-size: 15px;
            font-weight: 600;
            color: #FFD700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .code-cell {
            width: 150px;
            text-align: center;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }

        .code-cell div {
            font-weight: bold;
            color: white;
            font-size: 12px;
            margin: 4px 0;
        }

        /* Contenido del Formulario */
        .form-content {
            padding: 25px;
        }

        .section {
            margin-bottom: 25px;
            border: 2px solid #e8ecf1;
            border-radius: 15px;
            padding: 0;
            background: #ffffff;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .section:hover {
            box-shadow: 0 6px 25px rgba(0,0,0,0.12);
            transform: translateY(-2px);
        }

        .section-title {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 15px 20px;
            font-weight: bold;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-content {
            padding: 20px;
        }

        /* Tabla de datos b√°sicos responsive */
        .datos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
            font-size: 13px;
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #dfe6e9;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
            background: #f8f9fa;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3498db;
            background: white;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.1);
        }

        .turno-display {
            font-size: 28px;
            font-weight: bold;
            color: #FF6600;
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #fff5e6 0%, #ffe6cc 100%);
            border-radius: 10px;
            margin-top: 8px;
        }

        /* Radio buttons mejorados */
        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            background: #f8f9fa;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .radio-item:hover {
            background: #e8f4f8;
            border-color: #3498db;
        }

        .radio-item input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #3498db;
        }

        .radio-item input[type="radio"]:checked + label {
            color: #3498db;
            font-weight: bold;
        }

        .radio-item label {
            font-size: 14px;
            cursor: pointer;
            margin: 0;
        }

        /* Checkboxes para pruebas */
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            background: white;
            border-radius: 10px;
            border: 2px solid #ecf0f1;
            transition: all 0.3s;
            cursor: pointer;
        }

        .checkbox-item:hover {
            border-color: #3498db;
            background: #f0f8ff;
            transform: translateX(3px);
        }

        .checkbox-item input[type="checkbox"] {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: #3498db;
        }

        .checkbox-item input[type="checkbox"]:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }

        .checkbox-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #f5f5f5;
        }

        .checkbox-item.disabled:hover {
            border-color: #ecf0f1;
            background: #f5f5f5;
            transform: none;
        }

        .checkbox-item label {
            cursor: pointer;
            font-size: 13px;
            color: #2c3e50;
            flex: 1;
        }

        .checkbox-item.disabled label {
            cursor: not-allowed;
        }

        /* Tabla de inspecci√≥n responsive */
        .tabla-inspeccion {
            width: 100%;
            border-collapse: collapse;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .tabla-inspeccion th {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 15px 10px;
            font-size: 13px;
            font-weight: bold;
        }

        .tabla-inspeccion td {
            padding: 12px 10px;
            border-bottom: 1px solid #ecf0f1;
            font-size: 13px;
        }

        .tabla-inspeccion tr:hover {
            background: #f8f9fa;
        }

        .tabla-inspeccion td.radio-cell {
            text-align: center;
            width: 70px;
            background: #f8f9fa;
        }

        .tabla-inspeccion input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #27ae60;
        }

        /* Secci√≥n de condiciones moderna */
        .condiciones-section {
            background: linear-gradient(135deg, #E8F4F8 0%, #D6EAF8 100%);
            border: none;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .condiciones-titulo {
            background: linear-gradient(135deg, #3A9AD9 0%, #2E86C1 100%);
            color: white;
            padding: 15px 20px;
            font-weight: bold;
            font-size: 15px;
            margin: -25px -25px 20px -25px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-radius: 15px 15px 0 0;
        }

        .condiciones-alerta {
            background: linear-gradient(135deg, #FFF8DC 0%, #FFEAA7 100%);
            border: 2px solid #FFD700;
            padding: 18px;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(255, 215, 0, 0.2);
        }

        .condiciones-alerta h3 {
            color: #856404;
            font-size: 14px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-condicion {
            background: white;
            border: 2px solid #ddd;
            padding: 15px;
            margin: 12px 0;
            border-radius: 12px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .checkbox-condicion:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .checkbox-condicion.obligatoria {
            border-color: #FFD700;
            background: linear-gradient(135deg, #FFFEF0 0%, #FFFACD 100%);
        }

        .checkbox-condicion.opcional {
            border-color: #3498db;
            background: linear-gradient(135deg, #F0F8FF 0%, #E6F2FF 100%);
        }

        .checkbox-condicion input[type="checkbox"] {
            width: 24px;
            height: 24px;
            margin-top: 2px;
            cursor: pointer;
            flex-shrink: 0;
            accent-color: #27ae60;
        }

        .checkbox-condicion label {
            font-size: 13px;
            line-height: 1.6;
            cursor: pointer;
            flex: 1;
        }

        .checkbox-condicion label strong {
            color: #0033A0;
            font-size: 14px;
        }

        .nota-adicional {
            background: linear-gradient(135deg, #D6EAF8 0%, #AED6F1 100%);
            border-left: 5px solid #3A9AD9;
            padding: 15px;
            margin-top: 20px;
            font-size: 12px;
            line-height: 1.7;
            color: #1a5490;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        /* Firma moderna */
        .firma-container {
            margin-top: 25px;
            padding: 20px;
            background: white;
            border: 3px dashed #3A9AD9;
            border-radius: 15px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
        }

        .firma-label {
            font-weight: bold;
            color: #0033A0;
            margin-bottom: 15px;
            display: block;
            font-size: 15px;
            text-align: center;
        }

        #signature-pad {
            border: 3px solid #3498db;
            border-radius: 12px;
            cursor: crosshair;
            width: 100%;
            height: 200px;
            background: #fafafa;
            touch-action: none;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.05);
        }

        .firma-buttons {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        /* Botones modernos */
        .btn {
            padding: 14px 35px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-limpiar {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .btn-guardar {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
        }

        .btn-pdf {
            background: linear-gradient(135deg, #FF6600 0%, #E55A00 100%);
            color: white;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        /* Alertas mejoradas */
        .alert {
            padding: 18px 20px;
            margin: 20px 0;
            border-radius: 12px;
            font-weight: 600;
            display: none;
            animation: slideIn 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .alert-error {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            color: #721c24;
            border-left: 5px solid #c0392b;
        }

        .alert-success {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
            border-left: 5px solid #27ae60;
        }

        .alert.show {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Info badge para pruebas deshabilitadas */
        .info-badge {
            display: inline-block;
            padding: 8px 15px;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(9, 132, 227, 0.3);
        }

        /* Responsive optimizado para m√≥viles */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }

            .container {
                border-radius: 10px;
            }

            .form-content {
                padding: 15px;
            }

            .header-table td {
                padding: 10px;
            }

            .logo-cell {
                width: 80px;
            }

            .logo-img {
                max-width: 60px;
            }

            .title-cell h1 {
                font-size: 16px;
            }

            .title-cell h2 {
                font-size: 12px;
            }

            .code-cell {
                width: 90px;
            }

            .code-cell div {
                font-size: 10px;
            }

            .datos-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .checkbox-grid {
                grid-template-columns: 1fr;
            }

            .radio-group {
                flex-direction: column;
                gap: 10px;
            }

            .radio-item {
                width: 100%;
            }

            .tabla-inspeccion th,
            .tabla-inspeccion td {
                padding: 10px 8px;
                font-size: 12px;
            }

            .tabla-inspeccion td.radio-cell {
                width: 50px;
            }

            .section-content {
                padding: 15px;
            }

            .condiciones-section {
                padding: 15px;
            }

            .condiciones-titulo {
                margin: -15px -15px 15px -15px;
                padding: 12px 15px;
                font-size: 13px;
            }

            .checkbox-condicion {
                padding: 12px;
            }

            #signature-pad {
                height: 150px;
            }

            .btn {
                width: 100%;
                padding: 15px 20px;
            }

            .action-buttons {
                flex-direction: column;
                gap: 12px;
            }

            .turno-display {
                font-size: 24px;
            }
        }

        @media (max-width: 480px) {
            .title-cell h1 {
                font-size: 14px;
            }

            .title-cell h2 {
                font-size: 11px;
            }

            .section-title {
                font-size: 13px;
                padding: 12px 15px;
            }

            .tabla-inspeccion th,
            .tabla-inspeccion td {
                font-size: 11px;
                padding: 8px 5px;
            }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                border-radius: 0;
            }

            .btn, .firma-buttons, .action-buttons {
                display: none !important;
            }

            .section {
                break-inside: avoid;
            }

            @page {
                size: legal;
                margin: 1.5cm;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="printable-area">
        <!-- Header -->
        <table class="header-table">
            <tr>
                <td class="logo-cell">
                    <div class="logo-container">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImdyYWQiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMwMDMzQTA7c3RvcC1vcGFjaXR5OjEiIC8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjojMDA1NUNDO3N0b3Atb3BhY2l0eToxIiAvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjQ1IiBmaWxsPSJ1cmwoI2dyYWQpIi8+PHRleHQgeD0iNTAlIiB5PSI0MCUiIGZvbnQtc2l6ZT0iMjQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtd2VpZ2h0PSJib2xkIj5DREE8L3RleHQ+PHRleHQgeD0iNTAlIiB5PSI2NSUiIGZvbnQtc2l6ZT0iOCIgZmlsbD0iI0ZGRDcwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXdlaWdodD0iYm9sZCI+QkFSUkFOQ0FCRVJNRU9BPC90ZXh0Pjwvc3ZnPg==" alt="Logo CDA" class="logo-img">
                    </div>
                </td>
                <td class="title-cell">
                    <h1>CDA BARRANCABERMEJA</h1>
                    <h2>RECEPCI√ìN DE VEH√çCULOS LIVIANOS Y MOTOCICLETAS</h2>
                </td>
                <td class="code-cell">
                    <div>CDABR-GST-F-04</div>
                    <div>VER 14</div>
                    <div>2024-04-01</div>
                </td>
            </tr>
        </table>

        <div class="form-content">
            <!-- Alerta -->
            <div id="alert-container"></div>

            <!-- Secci√≥n 1: Datos B√°sicos -->
            <div class="section">
                <div class="section-title">üìã DATOS B√ÅSICOS DE RECEPCI√ìN</div>
                <div class="section-content">
                    <div class="datos-grid">
                        <div class="form-group">
                            <label>Fecha *</label>
                            <input type="date" id="fecha" required>
                        </div>
                        <div class="form-group">
                            <label>Hora *</label>
                            <input type="time" id="hora" required>
                        </div>
                        <div class="form-group">
                            <label>Placa *</label>
                            <input type="text" id="placa" placeholder="ABC123" required style="text-transform: uppercase;">
                        </div>
                        <div class="form-group">
                            <label>Turno</label>
                            <div class="turno-display" id="turno-display">18 18-1</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Visita *</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="visita1" name="visita" value="1" checked onchange="togglePruebasMecanizadas()">
                                <label for="visita1">Primera Vez (1¬™ Visita)</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="visita2" name="visita" value="2" onchange="togglePruebasMecanizadas()">
                                <label for="visita2">Segunda Vez (2¬™ Visita)</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Veh√≠culo Preparado *</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="prep-si" name="preparado" value="si" checked>
                                <label for="prep-si">‚úÖ S√≠</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="prep-no" name="preparado" value="no">
                                <label for="prep-no">‚ùå No</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n 2: Datos del Veh√≠culo -->
            <div class="section">
                <div class="section-title">üöô DATOS DEL VEH√çCULO</div>
                <div class="section-content">
                    <div class="datos-grid">
                        <div class="form-group">
                            <label>Marca</label>
                            <input type="text" id="marca" placeholder="Toyota">
                        </div>
                        <div class="form-group">
                            <label>Color</label>
                            <input type="text" id="color" placeholder="Blanco">
                        </div>
                        <div class="form-group">
                            <label>N√∫mero de Sillas</label>
                            <input type="number" id="num-sillas" placeholder="5" min="1">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Clase de Veh√≠culo *</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="clase-auto" name="clase" value="auto" checked>
                                <label for="clase-auto">üöó Auto</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="clase-camioneta" name="clase" value="camioneta">
                                <label for="clase-camioneta">üöô Camioneta</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="clase-campero" name="clase" value="campero">
                                <label for="clase-campero">üöê Campero</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="clase-moto" name="clase" value="moto">
                                <label for="clase-moto">üèçÔ∏è Moto 4T</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Tipo de Servicio *</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="servicio-particular" name="servicio" value="particular" checked>
                                <label for="servicio-particular">Particular</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="servicio-oficial" name="servicio" value="oficial">
                                <label for="servicio-oficial">Oficial</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="servicio-publico" name="servicio" value="publico">
                                <label for="servicio-publico">P√∫blico</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Tipo de Combustible *</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="comb-gasolina" name="combustible" value="gasolina" checked>
                                <label for="comb-gasolina">‚õΩ Gasolina</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="comb-gas" name="combustible" value="gas">
                                <label for="comb-gas">üî• Gas</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="comb-diesel" name="combustible" value="diesel">
                                <label for="comb-diesel">üõ¢Ô∏è Diesel</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="comb-electrico" name="combustible" value="electrico">
                                <label for="comb-electrico">‚ö° El√©ctrico</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n 3: Pruebas Mecanizadas (Din√°mico) -->
            <div class="section" id="pruebas-section">
                <div class="section-title">üîß PRUEBAS MECANIZADAS A REALIZAR</div>
                <div class="section-content">
                    <div class="info-badge" id="info-badge">
                        ‚ÑπÔ∏è Las pruebas solo se habilitan en la 2¬™ Visita
                    </div>
                    <div class="checkbox-grid" id="pruebas-container">
                        <div class="checkbox-item" id="item-alineacion">
                            <input type="checkbox" id="prueba-alineacion" disabled>
                            <label for="prueba-alineacion">üìê Alineaci√≥n</label>
                        </div>
                        <div class="checkbox-item" id="item-frenos">
                            <input type="checkbox" id="prueba-frenos" disabled>
                            <label for="prueba-frenos">üõë Frenos</label>
                        </div>
                        <div class="checkbox-item" id="item-gases">
                            <input type="checkbox" id="prueba-gases" disabled>
                            <label for="prueba-gases">üí® Gases</label>
                        </div>
                        <div class="checkbox-item" id="item-suspension">
                            <input type="checkbox" id="prueba-suspension" disabled>
                            <label for="prueba-suspension">üî© Suspensi√≥n</label>
                        </div>
                        <div class="checkbox-item" id="item-luces">
                            <input type="checkbox" id="prueba-luces" disabled>
                            <label for="prueba-luces">üí° Luces</label>
                        </div>
                        <div class="checkbox-item" id="item-opacidad">
                            <input type="checkbox" id="prueba-opacidad" disabled>
                            <label for="prueba-opacidad">üå´Ô∏è Opacidad</label>
                        </div>
                    </div>

                    <div class="form-group" style="margin-top: 20px;">
                        <label>Veh√≠culo P√∫blico Cumple</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="cumple-si" name="cumple" value="si">
                                <label for="cumple-si">‚úÖ S√≠</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="cumple-no" name="cumple" value="no" checked>
                                <label for="cumple-no">‚ùå No</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="cumple-na" name="cumple" value="na">
                                <label for="cumple-na">‚ûñ N/A</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n 4: Preparaci√≥n de la Muestra -->
            <div class="section">
                <div class="section-title">üëÅÔ∏è PREPARACI√ìN DE LA MUESTRA PARA SER INSPECCIONADO</div>
                <div class="section-content">
                    <table class="tabla-inspeccion">
                        <thead>
                            <tr>
                                <th style="text-align: left;">Descripci√≥n</th>
                                <th style="width: 70px;">S√≠</th>
                                <th style="width: 70px;">No</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Veh√≠culo descargado (vac√≠o)</td>
                                <td class="radio-cell"><input type="radio" name="insp-1" value="si" checked></td>
                                <td class="radio-cell"><input type="radio" name="insp-1" value="no"></td>
                            </tr>
                            <tr>
                                <td>Veh√≠culo limpio</td>
                                <td class="radio-cell"><input type="radio" name="insp-2" value="si" checked></td>
                                <td class="radio-cell"><input type="radio" name="insp-2" value="no"></td>
                            </tr>
                            <tr>
                                <td>Veh√≠culo sin tapas o copas</td>
                                <td class="radio-cell"><input type="radio" name="insp-3" value="si" checked></td>
                                <td class="radio-cell"><input type="radio" name="insp-3" value="no"></td>
                            </tr>
                            <tr>
                                <td>Alarma desactivada</td>
                                <td class="radio-cell"><input type="radio" name="insp-4" value="si" checked></td>
                                <td class="radio-cell"><input type="radio" name="insp-4" value="no"></td>
                            </tr>
                            <tr>
                                <td>Licencia de tr√°nsito del veh√≠culo</td>
                                <td class="radio-cell"><input type="radio" name="insp-5" value="si" checked></td>
                                <td class="radio-cell"><input type="radio" name="insp-5" value="no"></td>
                            </tr>
                            <tr>
                                <td>Certificado de gas natural vigente (veh√≠culos convertidos)</td>
                                <td class="radio-cell"><input type="radio" name="insp-6" value="si"></td>
                                <td class="radio-cell"><input type="radio" name="insp-6" value="no" checked></td>
                            </tr>
                            <tr>
                                <td>Llanta de repuesto visible</td>
                                <td class="radio-cell"><input type="radio" name="insp-7" value="si" checked></td>
                                <td class="radio-cell"><input type="radio" name="insp-7" value="no"></td>
                            </tr>
                            <tr>
                                <td>Correcta presi√≥n de los neum√°ticos</td>
                                <td class="radio-cell"><input type="radio" name="insp-8" value="si" checked></td>
                                <td class="radio-cell"><input type="radio" name="insp-8" value="no"></td>
                            </tr>
                            <tr>
                                <td>Correcto funcionamiento de al menos una luz del veh√≠culo</td>
                                <td class="radio-cell"><input type="radio" name="insp-9" value="si" checked></td>
                                <td class="radio-cell"><input type="radio" name="insp-9" value="no"></td>
                            </tr>
                            <tr>
                                <td>Veh√≠culo sin candado o carpa suelta (Si Aplica)</td>
                                <td class="radio-cell"><input type="radio" name="insp-10" value="si" checked></td>
                                <td class="radio-cell"><input type="radio" name="insp-10" value="no"></td>
                            </tr>
                            <tr>
                                <td>Indicador de nivel de l√≠quido de frenos de la moto visible (Si Aplica)</td>
                                <td class="radio-cell"><input type="radio" name="insp-11" value="si"></td>
                                <td class="radio-cell"><input type="radio" name="insp-11" value="no" checked></td>
                            </tr>
                            <tr>
                                <td>Motocicleta de transmisi√≥n autom√°tica con soporte central</td>
                                <td class="radio-cell"><input type="radio" name="insp-12" value="si"></td>
                                <td class="radio-cell"><input type="radio" name="insp-12" value="no" checked></td>
                            </tr>
                            <tr>
                                <td>Motocicleta con porta casco o maletero vac√≠o (si aplica)</td>
                                <td class="radio-cell"><input type="radio" name="insp-13" value="si"></td>
                                <td class="radio-cell"><input type="radio" name="insp-13" value="no" checked></td>
                            </tr>
                            <tr>
                                <td>Veh√≠culo Bicombustible operando a gasolina (Si aplica)</td>
                                <td class="radio-cell"><input type="radio" name="insp-14" value="si"></td>
                                <td class="radio-cell"><input type="radio" name="insp-14" value="no" checked></td>
                            </tr>
                            <tr>
                                <td>Veh√≠culo en modo inspecci√≥n (Si aplica, h√≠bridos)</td>
                                <td class="radio-cell"><input type="radio" name="insp-15" value="si"></td>
                                <td class="radio-cell"><input type="radio" name="insp-15" value="no" checked></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Secci√≥n 5: Campos Adicionales -->
            <div class="section">
                <div class="section-title">üìù INFORMACI√ìN ADICIONAL</div>
                <div class="section-content">
                    <div class="datos-grid">
                        <div class="form-group">
                            <label>Certificado GNV N¬∞</label>
                            <input type="text" id="cert-gnv" placeholder="Si aplica">
                        </div>
                        <div class="form-group">
                            <label>F. Vigilancia</label>
                            <input type="date" id="f-vigilancia">
                        </div>
                        <div class="form-group">
                            <label>Tipo de Carrocer√≠a</label>
                            <select id="tipo-carroceria">
                                <option value="">Seleccione...</option>
                                <option value="sedan">Sed√°n</option>
                                <option value="hatchback">Hatchback</option>
                                <option value="suv">SUV</option>
                                <option value="pickup">Pickup</option>
                                <option value="van">Van</option>
                                <option value="otro">Otro</option>
                            </select>
                        </div>
                    </div>

                    <div class="datos-grid" style="grid-template-columns: 1fr 1fr;">
                        <div class="form-group">
                            <label>Blindaje</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" id="blindaje-si" name="blindaje" value="si">
                                    <label for="blindaje-si">S√≠</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="blindaje-no" name="blindaje" value="no" checked>
                                    <label for="blindaje-no">No</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Tracci√≥n 4x4</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" id="traccion-si" name="traccion" value="si">
                                    <label for="traccion-si">S√≠</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="traccion-no" name="traccion" value="no" checked>
                                    <label for="traccion-no">No</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>C√≥digo de Alarma</label>
                        <input type="text" id="codigo-alarma" placeholder="Si su veh√≠culo tiene alarma, ingrese el c√≥digo de desactivaci√≥n">
                    </div>
                </div>
            </div>

            <!-- Secci√≥n 6: Condiciones y Firma -->
            <div class="condiciones-section">
                <div class="condiciones-titulo">
                    ‚úçÔ∏è ACEPTACI√ìN DE CONDICIONES Y FIRMA
                </div>

                <div class="condiciones-alerta">
                    <h3>‚ö†Ô∏è CONDICIONES IMPORTANTES - Seleccione las que aplican</h3>
                </div>

                <!-- Checkboxes Obligatorios -->
                <div class="checkbox-condicion obligatoria">
                    <input type="checkbox" id="cond-obligatoria-1" class="check-obligatorio" required>
                    <label for="cond-obligatoria-1">
                        <strong>üü¢ OBLIGATORIA:</strong> Se√±or cliente (o usuario), las condiciones al ingresar del veh√≠culo se√±aladas son ciertas
                    </label>
                </div>

                <div class="checkbox-condicion obligatoria">
                    <input type="checkbox" id="cond-obligatoria-2" class="check-obligatorio" required>
                    <label for="cond-obligatoria-2">
                        <strong>üü¢ OBLIGATORIA:</strong> Se√±or cliente, acepta las condiciones en la que sali√≥ su veh√≠culo
                    </label>
                </div>

                <!-- Checkboxes Opcionales -->
                <div class="checkbox-condicion opcional">
                    <input type="checkbox" id="cond-opcional-1" class="check-opcional">
                    <label for="cond-opcional-1">
                        <strong>üîµ OPCIONAL:</strong> Acepto que me contacten para gesti√≥n comercial, recordatorios de pr√≥ximo vencimiento
                    </label>
                </div>

                <div class="checkbox-condicion opcional">
                    <input type="checkbox" id="cond-opcional-2" class="check-opcional">
                    <label for="cond-opcional-2">
                        <strong>üîµ OPCIONAL:</strong> Acepto el tratamiento de mis datos personales seg√∫n pol√≠tica de privacidad
                    </label>
                </div>

                <!-- Nota adicional -->
                <div class="nota-adicional">
                    <strong>üìå Nota adicional:</strong> El Se√±or Recepcionista deber√° registrar las presiones de las llantas del veh√≠culo y el estado en que ingresa usando las convenciones indicadas. Si su veh√≠culo automotor cuenta con sistema de seguridad, por favor desact√≠velo.
                </div>

                <!-- Firma del Cliente -->
                <div class="firma-container">
                    <label class="firma-label">Firma del Cliente (use dedo o mouse)</label>
                    <canvas id="signature-pad"></canvas>
                    <div class="firma-buttons">
                        <button class="btn btn-limpiar" onclick="clearSignature()">üóëÔ∏è Limpiar Firma</button>
                    </div>
                </div>
            </div>

            <!-- Botones de Acci√≥n -->
            <div class="action-buttons">
                <button class="btn btn-guardar" onclick="saveRecord()">üíæ Guardar Registro</button>
                <button class="btn btn-pdf" onclick="generatePDF()">üìÑ Exportar a PDF (Oficio)</button>
            </div>
        </div>
    </div>

    <script>
        // Configuraci√≥n inicial
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            document.getElementById('fecha').valueAsDate = now;
            document.getElementById('hora').value = now.toTimeString().slice(0,5);
            
            setupSignaturePad();
            togglePruebasMecanizadas(); // Inicializar estado
        });

        // Funci√≥n para habilitar/deshabilitar pruebas mecanizadas seg√∫n visita
        function togglePruebasMecanizadas() {
            const visita = document.querySelector('input[name="visita"]:checked').value;
            const pruebas = ['alineacion', 'frenos', 'gases', 'suspension', 'luces', 'opacidad'];
            const infoBadge = document.getElementById('info-badge');
            
            if (visita === '1') {
                // Primera vez: deshabilitar todas las pruebas
                pruebas.forEach(prueba => {
                    const checkbox = document.getElementById(`prueba-${prueba}`);
                    const item = document.getElementById(`item-${prueba}`);
                    checkbox.disabled = true;
                    checkbox.checked = false;
                    item.classList.add('disabled');
                });
                infoBadge.style.display = 'inline-block';
                infoBadge.textContent = '‚ÑπÔ∏è Las pruebas solo se habilitan en la 2¬™ Visita';
                infoBadge.style.background = 'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)';
            } else {
                // Segunda vez: habilitar todas las pruebas
                pruebas.forEach(prueba => {
                    const checkbox = document.getElementById(`prueba-${prueba}`);
                    const item = document.getElementById(`item-${prueba}`);
                    checkbox.disabled = false;
                    item.classList.remove('disabled');
                });
                infoBadge.style.display = 'inline-block';
                infoBadge.textContent = '‚úÖ Pruebas habilitadas - Seleccione las que desee realizar';
                infoBadge.style.background = 'linear-gradient(135deg, #55efc4 0%, #00b894 100%)';
            }
        }

        // Configurar Canvas para firma
        function setupSignaturePad() {
            const canvas = document.getElementById('signature-pad');
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.offsetWidth;
            canvas.height = 200;
            
            let drawing = false;
            let lastX = 0;
            let lastY = 0;

            function startDrawing(e) {
                drawing = true;
                const rect = canvas.getBoundingClientRect();
                lastX = (e.clientX || e.touches[0].clientX) - rect.left;
                lastY = (e.clientY || e.touches[0].clientY) - rect.top;
            }

            function draw(e) {
                if (!drawing) return;
                e.preventDefault();
                
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;

                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(x, y);
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.stroke();

                lastX = x;
                lastY = y;
            }

            function stopDrawing() {
                drawing = false;
            }

            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);

            canvas.addEventListener('touchstart', startDrawing);
            canvas.addEventListener('touchmove', draw);
            canvas.addEventListener('touchend', stopDrawing);
        }

        function clearSignature() {
            const canvas = document.getElementById('signature-pad');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function showAlert(message, type) {
            const container = document.getElementById('alert-container');
            const icon = type === 'success' ? '‚úÖ' : '‚ùå';
            container.innerHTML = `<div class="alert alert-${type} show">${icon} ${message}</div>`;
            
            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }

        function validateForm() {
            const fecha = document.getElementById('fecha').value;
            const hora = document.getElementById('hora').value;
            const placa = document.getElementById('placa').value;

            if (!fecha || !hora || !placa) {
                showAlert('Por favor complete los campos obligatorios: Fecha, Hora y Placa', 'error');
                return false;
            }

            const checksObligatorios = document.querySelectorAll('.check-obligatorio');
            let todosChecked = true;

            checksObligatorios.forEach(check => {
                if (!check.checked) {
                    todosChecked = false;
                }
            });

            if (!todosChecked) {
                showAlert('Debe aceptar todas las condiciones OBLIGATORIAS marcadas con üü¢', 'error');
                return false;
            }

            const canvas = document.getElementById('signature-pad');
            const ctx = canvas.getContext('2d');
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const isEmpty = !imageData.data.some(channel => channel !== 0);

            if (isEmpty) {
                showAlert('Por favor firme el documento antes de guardar', 'error');
                return false;
            }

            return true;
        }

        function collectFormData() {
            const data = {
                fecha: document.getElementById('fecha').value,
                hora: document.getElementById('hora').value,
                placa: document.getElementById('placa').value.toUpperCase(),
                visita: document.querySelector('input[name="visita"]:checked').value,
                preparado: document.querySelector('input[name="preparado"]:checked').value,
                marca: document.getElementById('marca').value,
                color: document.getElementById('color').value,
                numSillas: document.getElementById('num-sillas').value,
                clase: document.querySelector('input[name="clase"]:checked').value,
                servicio: document.querySelector('input[name="servicio"]:checked').value,
                combustible: document.querySelector('input[name="combustible"]:checked').value,
                cumple: document.querySelector('input[name="cumple"]:checked').value,
                pruebas: [],
                inspeccion: {},
                condiciones: {
                    obligatorias: [],
                    opcionales: []
                },
                firma: document.getElementById('signature-pad').toDataURL(),
                timestamp: new Date().toISOString()
            };

            ['alineacion', 'frenos', 'gases', 'suspension', 'luces', 'opacidad'].forEach(prueba => {
                const checkbox = document.getElementById(`prueba-${prueba}`);
                if (checkbox.checked && !checkbox.disabled) {
                    data.pruebas.push(prueba);
                }
            });

            for (let i = 1; i <= 15; i++) {
                const selected = document.querySelector(`input[name="insp-${i}"]:checked`);
                if (selected) {
                    data.inspeccion[`item${i}`] = selected.value;
                }
            }

            document.querySelectorAll('.check-obligatorio').forEach((check, index) => {
                data.condiciones.obligatorias.push({
                    id: index + 1,
                    checked: check.checked
                });
            });

            document.querySelectorAll('.check-opcional').forEach((check, index) => {
                data.condiciones.opcionales.push({
                    id: index + 1,
                    checked: check.checked
                });
            });

            return data;
        }

        function saveRecord() {
            if (!validateForm()) {
                return;
            }

            const data = collectFormData();
            const registros = JSON.parse(localStorage.getItem('registros-cda') || '[]');
            registros.push(data);
            localStorage.setItem('registros-cda', JSON.stringify(registros));

            showAlert('Registro guardado exitosamente en el sistema', 'success');
        }

        function generatePDF() {
            if (!validateForm()) {
                return;
            }

            const buttons = document.querySelectorAll('.btn, .firma-buttons');
            buttons.forEach(btn => btn.style.display = 'none');

            const element = document.getElementById('printable-area');
            
            html2canvas(element, {
                scale: 2,
                useCORS: true,
                logging: false,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'legal');
                
                const imgWidth = 215.9;
                const pageHeight = 355.6;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;

                const imgData = canvas.toDataURL('image/png');
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                const placa = document.getElementById('placa').value;
                const fecha = document.getElementById('fecha').value;
                pdf.save(`Recepcion_CDA_${placa}_${fecha}.pdf`);

                buttons.forEach(btn => btn.style.display = '');
                showAlert('PDF generado exitosamente', 'success');
            });
        }

        document.getElementById('placa').addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase();
        });
    </script>
</body>
</html>
