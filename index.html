<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recepci√≥n de Veh√≠culos y Motocicletas - CDA Barrancabermeja</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            padding: 15px;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        /* Header con logo */
        .header-table {
            width: 100%;
            border-collapse: collapse;
            border: 2px solid #0033A0;
        }

        .header-table td {
            border: 1px solid #0033A0;
            padding: 10px;
            vertical-align: middle;
        }

        .logo-cell {
            width: 150px;
            text-align: center;
            background: white;
        }

        .logo-img {
            max-width: 120px;
            height: auto;
        }

        .title-cell {
            text-align: center;
            background: white;
        }

        .title-cell h1 {
            font-size: 18px;
            font-weight: bold;
            color: #0033A0;
            margin-bottom: 5px;
        }

        .title-cell h2 {
            font-size: 14px;
            font-weight: bold;
            color: #0033A0;
        }

        .code-cell {
            width: 200px;
            text-align: center;
            background: white;
        }

        .code-cell div {
            font-weight: bold;
            color: #0033A0;
            font-size: 13px;
            margin: 3px 0;
        }

        /* Secci√≥n de datos b√°sicos */
        .datos-basicos {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            border: 2px solid #0033A0;
        }

        .datos-basicos th {
            background: #0033A0;
            color: white;
            padding: 8px;
            font-size: 13px;
            font-weight: bold;
            border: 1px solid #0033A0;
        }

        .datos-basicos td {
            padding: 10px;
            border: 1px solid #0033A0;
        }

        .datos-basicos input[type="text"],
        .datos-basicos input[type="date"],
        .datos-basicos input[type="time"],
        .datos-basicos input[type="number"] {
            width: 100%;
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 14px;
        }

        .turno-especial {
            font-size: 22px;
            font-weight: bold;
            color: #FF6600;
            text-align: center;
        }

        /* Radio buttons */
        .radio-group {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .radio-item input[type="radio"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .radio-item label {
            font-size: 13px;
            cursor: pointer;
        }

        /* Secci√≥n de detalles del veh√≠culo */
        .seccion-titulo {
            background: #0033A0;
            color: white;
            padding: 8px 15px;
            font-weight: bold;
            font-size: 13px;
            margin-top: 10px;
        }

        .detalle-vehiculo {
            width: 100%;
            border-collapse: collapse;
            border: 2px solid #0033A0;
        }

        .detalle-vehiculo td {
            padding: 8px;
            border: 1px solid #0033A0;
        }

        .detalle-vehiculo .label-cell {
            background: #0033A0;
            color: white;
            font-weight: bold;
            font-size: 13px;
            width: 200px;
        }

        /* Checkboxes para pruebas */
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            padding: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-item label {
            font-size: 13px;
            cursor: pointer;
        }

        /* Tabla de inspecci√≥n */
        .tabla-inspeccion {
            width: 100%;
            border-collapse: collapse;
            border: 2px solid #0033A0;
            margin-top: 10px;
        }

        .tabla-inspeccion th {
            background: #0033A0;
            color: white;
            padding: 10px;
            font-size: 13px;
            font-weight: bold;
            border: 1px solid #0033A0;
        }

        .tabla-inspeccion td {
            padding: 10px;
            border: 1px solid #0033A0;
            font-size: 12px;
        }

        .tabla-inspeccion td.radio-cell {
            text-align: center;
            width: 60px;
        }

        .tabla-inspeccion input[type="radio"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* Secci√≥n de condiciones y firma */
        .condiciones-section {
            background: #E8F4F8;
            border: 2px solid #0033A0;
            padding: 20px;
            margin-top: 15px;
        }

        .condiciones-titulo {
            background: #3A9AD9;
            color: white;
            padding: 10px 15px;
            font-weight: bold;
            font-size: 14px;
            margin: -20px -20px 15px -20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .condiciones-alerta {
            background: #FFF8DC;
            border: 2px solid #FFD700;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }

        .condiciones-alerta h3 {
            color: #856404;
            font-size: 14px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-condicion {
            background: white;
            border: 2px solid #ddd;
            padding: 12px;
            margin: 8px 0;
            border-radius: 5px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .checkbox-condicion.obligatoria {
            border-color: #FFD700;
            background: #FFFEF0;
        }

        .checkbox-condicion.opcional {
            border-color: #CCC;
            background: #F9F9F9;
        }

        .checkbox-condicion input[type="checkbox"] {
            width: 22px;
            height: 22px;
            margin-top: 2px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .checkbox-condicion label {
            font-size: 13px;
            line-height: 1.5;
            cursor: pointer;
            flex: 1;
        }

        .checkbox-condicion label strong {
            color: #0033A0;
        }

        .nota-adicional {
            background: #D6EAF8;
            border-left: 4px solid #3A9AD9;
            padding: 12px;
            margin-top: 15px;
            font-size: 12px;
            line-height: 1.6;
            color: #333;
        }

        /* Firma */
        .firma-container {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border: 3px dashed #3A9AD9;
            border-radius: 8px;
        }

        .firma-label {
            font-weight: bold;
            color: #0033A0;
            margin-bottom: 10px;
            display: block;
            font-size: 14px;
        }

        #signature-pad {
            border: 2px solid #0033A0;
            border-radius: 5px;
            cursor: crosshair;
            width: 100%;
            height: 180px;
            background: white;
            touch-action: none;
        }

        .firma-buttons {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        /* Botones */
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .btn-limpiar {
            background: #e74c3c;
            color: white;
        }

        .btn-limpiar:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .btn-guardar {
            background: #27ae60;
            color: white;
        }

        .btn-guardar:hover {
            background: #229954;
            transform: translateY(-2px);
        }

        .btn-pdf {
            background: #FF6600;
            color: white;
        }

        .btn-pdf:hover {
            background: #E55A00;
            transform: translateY(-2px);
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        /* Alertas */
        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-weight: bold;
            display: none;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .alert.show {
            display: block;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .checkbox-grid {
                grid-template-columns: 1fr;
            }

            .datos-basicos th,
            .datos-basicos td {
                display: block;
                width: 100%;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
            }

            .btn, .firma-buttons {
                display: none !important;
            }

            @page {
                size: legal;
                margin: 1.5cm;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="printable-area">
        <!-- Header -->
        <table class="header-table">
            <tr>
                <td class="logo-cell">
                    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI2MCIgY3k9IjUwIiByPSI0NSIgZmlsbD0iIzAwMzNBMCIvPjx0ZXh0IHg9IjUwJSIgeT0iNDUlIiBmb250LXNpemU9IjI0IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXdlaWdodD0iYm9sZCI+Q0RBPC90ZXh0Pjx0ZXh0IHg9IjUwJSIgeT0iNzAlIiBmb250LXNpemU9IjEwIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXdlaWdodD0iYm9sZCI+QkFSUkFOQ0FCRVJNRU9BPC90ZXh0Pjwvc3ZnPg==" alt="Logo CDA" class="logo-img">
                </td>
                <td class="title-cell">
                    <h1>CDA BARRANCABERMEJA</h1>
                    <h2>RECEPCI√ìN DE VEH√çCULOS LIVIANOS Y MOTOCICLETAS</h2>
                </td>
                <td class="code-cell">
                    <div>CDABR-GST-F-04</div>
                    <div>VER 14</div>
                    <div>2024-04-01</div>
                </td>
            </tr>
        </table>

        <!-- Alerta -->
        <div id="alert-container"></div>

        <!-- Datos B√°sicos -->
        <table class="datos-basicos">
            <tr>
                <th>Fecha</th>
                <th>Hora</th>
                <th>Placa</th>
                <th>Visita</th>
                <th>Veh√≠culo Preparado</th>
                <th>Turno</th>
            </tr>
            <tr>
                <td><input type="date" id="fecha" required></td>
                <td><input type="time" id="hora" required></td>
                <td><input type="text" id="placa" placeholder="ABC123" required style="text-transform: uppercase;"></td>
                <td>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="visita1" name="visita" value="1" checked>
                            <label for="visita1">1¬™</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="visita2" name="visita" value="2">
                            <label for="visita2">2¬™</label>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="prep-si" name="preparado" value="si" checked>
                            <label for="prep-si">S√≠</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="prep-no" name="preparado" value="no">
                            <label for="prep-no">No</label>
                        </div>
                    </div>
                </td>
                <td><div class="turno-especial" id="turno-display">18 18-1</div></td>
            </tr>
        </table>

        <!-- Marca y Color -->
        <table class="datos-basicos" style="margin-top: 5px;">
            <tr>
                <th>Marca</th>
                <th colspan="2">Color</th>
                <th>Prueba(s) Mecanizadas a Realizar</th>
                <th>Veh√≠culo P√∫blico</th>
            </tr>
            <tr>
                <td><input type="text" id="marca" placeholder="Toyota"></td>
                <td colspan="2"><input type="text" id="color" placeholder="Blanco"></td>
                <td>
                    <div class="checkbox-grid" style="grid-template-columns: repeat(2, 1fr);">
                        <div class="checkbox-item">
                            <input type="checkbox" id="prueba-alineacion">
                            <label for="prueba-alineacion">Alineaci√≥n</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="prueba-frenos">
                            <label for="prueba-frenos">Frenos</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="prueba-gases">
                            <label for="prueba-gases">Gases</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="prueba-suspension">
                            <label for="prueba-suspension">Suspensi√≥n</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="prueba-luces">
                            <label for="prueba-luces">Luces</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="prueba-opacidad">
                            <label for="prueba-opacidad">Opacidad</label>
                        </div>
                    </div>
                </td>
                <td>
                    <div style="text-align: center; margin-bottom: 5px; font-size: 12px;">N¬∫ de Sillas:</div>
                    <input type="number" id="num-sillas" placeholder="5" min="1" style="margin-bottom: 10px;">
                    <div style="font-size: 12px; margin-bottom: 5px;">Cumple:</div>
                    <div class="radio-group" style="justify-content: center;">
                        <div class="radio-item">
                            <input type="radio" id="cumple-si" name="cumple" value="si">
                            <label for="cumple-si">S√≠</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="cumple-no" name="cumple" value="no" checked>
                            <label for="cumple-no">No</label>
                        </div>
                    </div>
                </td>
            </tr>
        </table>

        <!-- Tabla de Inspecci√≥n -->
        <div class="seccion-titulo">Preparaci√≥n de la Muestra para ser Inspeccionado</div>
        <table class="tabla-inspeccion">
            <thead>
                <tr>
                    <th style="text-align: left;">Descripci√≥n</th>
                    <th style="width: 60px;">S√≠</th>
                    <th style="width: 60px;">No</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Veh√≠culo descargado (vac√≠o)</td>
                    <td class="radio-cell"><input type="radio" name="insp-1" value="si" checked></td>
                    <td class="radio-cell"><input type="radio" name="insp-1" value="no"></td>
                </tr>
                <tr>
                    <td>Veh√≠culo limpio</td>
                    <td class="radio-cell"><input type="radio" name="insp-2" value="si" checked></td>
                    <td class="radio-cell"><input type="radio" name="insp-2" value="no"></td>
                </tr>
                <tr>
                    <td>Veh√≠culo sin tapas o copas</td>
                    <td class="radio-cell"><input type="radio" name="insp-3" value="si" checked></td>
                    <td class="radio-cell"><input type="radio" name="insp-3" value="no"></td>
                </tr>
                <tr>
                    <td>Alarma desactivada</td>
                    <td class="radio-cell"><input type="radio" name="insp-4" value="si" checked></td>
                    <td class="radio-cell"><input type="radio" name="insp-4" value="no"></td>
                </tr>
                <tr>
                    <td>Licencia de tr√°nsito del veh√≠culo</td>
                    <td class="radio-cell"><input type="radio" name="insp-5" value="si" checked></td>
                    <td class="radio-cell"><input type="radio" name="insp-5" value="no"></td>
                </tr>
                <tr>
                    <td>Certificado de gas natural vigente (veh√≠culos convertidos)</td>
                    <td class="radio-cell"><input type="radio" name="insp-6" value="si"></td>
                    <td class="radio-cell"><input type="radio" name="insp-6" value="no" checked></td>
                </tr>
                <tr>
                    <td>Llanta de repuesto visible</td>
                    <td class="radio-cell"><input type="radio" name="insp-7" value="si" checked></td>
                    <td class="radio-cell"><input type="radio" name="insp-7" value="no"></td>
                </tr>
                <tr>
                    <td>Correcta presi√≥n de los neum√°ticos</td>
                    <td class="radio-cell"><input type="radio" name="insp-8" value="si" checked></td>
                    <td class="radio-cell"><input type="radio" name="insp-8" value="no"></td>
                </tr>
                <tr>
                    <td>Correcto funcionamiento de al menos una luz del veh√≠culo</td>
                    <td class="radio-cell"><input type="radio" name="insp-9" value="si" checked></td>
                    <td class="radio-cell"><input type="radio" name="insp-9" value="no"></td>
                </tr>
                <tr>
                    <td>Veh√≠culo sin candado o carpa suelta (Si Aplica)</td>
                    <td class="radio-cell"><input type="radio" name="insp-10" value="si" checked></td>
                    <td class="radio-cell"><input type="radio" name="insp-10" value="no"></td>
                </tr>
                <tr>
                    <td>Indicador de nivel de l√≠quido de frenos de la moto visible (Si Aplica)</td>
                    <td class="radio-cell"><input type="radio" name="insp-11" value="si"></td>
                    <td class="radio-cell"><input type="radio" name="insp-11" value="no" checked></td>
                </tr>
                <tr>
                    <td>Motocicleta de transmisi√≥n autom√°tica con soporte central</td>
                    <td class="radio-cell"><input type="radio" name="insp-12" value="si"></td>
                    <td class="radio-cell"><input type="radio" name="insp-12" value="no" checked></td>
                </tr>
                <tr>
                    <td>Motocicleta con porta casco o maletero vac√≠o (si aplica)</td>
                    <td class="radio-cell"><input type="radio" name="insp-13" value="si"></td>
                    <td class="radio-cell"><input type="radio" name="insp-13" value="no" checked></td>
                </tr>
                <tr>
                    <td>Veh√≠culo Bicombustible operando a gasolina (Si aplica)</td>
                    <td class="radio-cell"><input type="radio" name="insp-14" value="si"></td>
                    <td class="radio-cell"><input type="radio" name="insp-14" value="no" checked></td>
                </tr>
                <tr>
                    <td>Veh√≠culo en modo inspecci√≥n (Si aplica, h√≠bridos)</td>
                    <td class="radio-cell"><input type="radio" name="insp-15" value="si"></td>
                    <td class="radio-cell"><input type="radio" name="insp-15" value="no" checked></td>
                </tr>
            </tbody>
        </table>

        <!-- Clase de Veh√≠culo -->
        <div class="seccion-titulo" style="margin-top: 15px;">Clase de Veh√≠culo</div>
        <table class="detalle-vehiculo">
            <tr>
                <td colspan="4">
                    <div class="radio-group" style="justify-content: space-around;">
                        <div class="radio-item">
                            <input type="radio" id="clase-auto" name="clase" value="auto" checked>
                            <label for="clase-auto">Auto</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="clase-camioneta" name="clase" value="camioneta">
                            <label for="clase-camioneta">Camioneta</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="clase-campero" name="clase" value="campero">
                            <label for="clase-campero">Campero</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="clase-moto" name="clase" value="moto">
                            <label for="clase-moto">Moto 4T</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="clase-otro" name="clase" value="otro">
                            <label for="clase-otro">Otro</label>
                        </div>
                    </div>
                </td>
            </tr>
        </table>

        <!-- Tipo de Servicio -->
        <div class="seccion-titulo" style="margin-top: 10px;">Tipo de Servicio</div>
        <table class="detalle-vehiculo">
            <tr>
                <td>
                    <div class="radio-group" style="justify-content: space-around;">
                        <div class="radio-item">
                            <input type="radio" id="servicio-particular" name="servicio" value="particular" checked>
                            <label for="servicio-particular">Particular</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="servicio-oficial" name="servicio" value="oficial">
                            <label for="servicio-oficial">Oficial</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="servicio-publico" name="servicio" value="publico">
                            <label for="servicio-publico">P√∫blico</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="servicio-otro" name="servicio" value="otro">
                            <label for="servicio-otro">Otro</label>
                        </div>
                    </div>
                </td>
            </tr>
        </table>

        <!-- Tipo de Combustible -->
        <div class="seccion-titulo" style="margin-top: 10px;">Tipo de Combustible</div>
        <table class="detalle-vehiculo">
            <tr>
                <td>
                    <div class="radio-group" style="justify-content: space-around;">
                        <div class="radio-item">
                            <input type="radio" id="comb-gasolina" name="combustible" value="gasolina" checked>
                            <label for="comb-gasolina">Gasolina</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="comb-gas" name="combustible" value="gas">
                            <label for="comb-gas">Gas</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="comb-diesel" name="combustible" value="diesel">
                            <label for="comb-diesel">Diesel</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="comb-electrico" name="combustible" value="electrico">
                            <label for="comb-electrico">El√©ctrico</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="comb-otro" name="combustible" value="otro">
                            <label for="comb-otro">Otro</label>
                        </div>
                    </div>
                </td>
            </tr>
        </table>

        <!-- Campos adicionales -->
        <table class="datos-basicos" style="margin-top: 10px;">
            <tr>
                <th>Certificado GNV N¬∞</th>
                <th>F. Vigilancia:</th>
                <th>Tipo de Carrocer√≠a</th>
                <th>Blindaje</th>
                <th>Tracci√≥n 4x4</th>
            </tr>
            <tr>
                <td><input type="text" id="cert-gnv" placeholder="Si aplica"></td>
                <td><input type="date" id="f-vigilancia"></td>
                <td>
                    <select id="tipo-carroceria" style="width: 100%; padding: 6px;">
                        <option value="">Seleccione...</option>
                        <option value="sedan">Sed√°n</option>
                        <option value="hatchback">Hatchback</option>
                        <option value="suv">SUV</option>
                        <option value="pickup">Pickup</option>
                        <option value="van">Van</option>
                        <option value="otro">Otro</option>
                    </select>
                </td>
                <td>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="blindaje-si" name="blindaje" value="si">
                            <label for="blindaje-si">S√≠</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="blindaje-no" name="blindaje" value="no" checked>
                            <label for="blindaje-no">No</label>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="traccion-si" name="traccion" value="si">
                            <label for="traccion-si">S√≠</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="traccion-no" name="traccion" value="no" checked>
                            <label for="traccion-no">No</label>
                        </div>
                    </div>
                </td>
            </tr>
        </table>

        <!-- C√≥digo de Alarma -->
        <div class="seccion-titulo" style="margin-top: 10px;">C√≥digo Alarma</div>
        <table class="detalle-vehiculo">
            <tr>
                <td style="padding: 15px;">
                    <input type="text" id="codigo-alarma" placeholder="Si su veh√≠culo automotor cuenta con sistema de seguridad, por favor desact√≠velo" style="width: 100%; padding: 10px; font-size: 13px;">
                    <div style="margin-top: 10px; font-size: 12px; font-style: italic; color: #555;">
                        Se√±or Recepcionista registre a continuaci√≥n las presiones de las llantas del veh√≠culo y el estado en que ingresa usando las convenciones indicadas.
                    </div>
                </td>
            </tr>
        </table>

        <!-- Secci√≥n de Condiciones y Firma -->
        <div class="condiciones-section">
            <div class="condiciones-titulo">
                ‚úçÔ∏è ACEPTACI√ìN DE CONDICIONES Y FIRMA
            </div>

            <div class="condiciones-alerta">
                <h3>‚ö†Ô∏è CONDICIONES IMPORTANTES - Seleccione las que aplican</h3>
            </div>

            <!-- Checkboxes Obligatorios -->
            <div class="checkbox-condicion obligatoria">
                <input type="checkbox" id="cond-obligatoria-1" class="check-obligatorio" required>
                <label for="cond-obligatoria-1">
                    <strong>üü¢ OBLIGATORIA:</strong> Se√±or cliente (o usuario), las condiciones al ingresar del veh√≠culo se√±aladas son ciertas
                </label>
            </div>

            <div class="checkbox-condicion obligatoria">
                <input type="checkbox" id="cond-obligatoria-2" class="check-obligatorio" required>
                <label for="cond-obligatoria-2">
                    <strong>üü¢ OBLIGATORIA:</strong> Se√±or cliente, acepta las condiciones en la que sali√≥ su veh√≠culo
                </label>
            </div>

            <!-- Checkboxes Opcionales -->
            <div class="checkbox-condicion opcional">
                <input type="checkbox" id="cond-opcional-1" class="check-opcional">
                <label for="cond-opcional-1">
                    <strong>üîµ OPCIONAL:</strong> Acepto que me contacten para gesti√≥n comercial, recordatorios de pr√≥ximo vencimiento
                </label>
            </div>

            <div class="checkbox-condicion opcional">
                <input type="checkbox" id="cond-opcional-2" class="check-opcional">
                <label for="cond-opcional-2">
                    <strong>üîµ OPCIONAL:</strong> Acepto el tratamiento de mis datos personales seg√∫n pol√≠tica de privacidad
                </label>
            </div>

            <!-- Nota adicional -->
            <div class="nota-adicional">
                <strong>Nota adicional:</strong> El Se√±or Recepcionista deber√° registrar las presiones de las llantas del veh√≠culo y el estado en que ingresa usando las convenciones indicadas. Si su veh√≠culo automotor cuenta con sistema de seguridad, por favor desact√≠velo.
            </div>

            <!-- Firma del Cliente -->
            <div class="firma-container">
                <label class="firma-label">Firma del Cliente (use dedo o mouse)</label>
                <canvas id="signature-pad"></canvas>
                <div class="firma-buttons">
                    <button class="btn btn-limpiar" onclick="clearSignature()">üóëÔ∏è Limpiar Firma</button>
                </div>
            </div>
        </div>

        <!-- Botones de Acci√≥n -->
        <div class="action-buttons">
            <button class="btn btn-guardar" onclick="saveRecord()">üíæ Guardar Registro</button>
            <button class="btn btn-pdf" onclick="generatePDF()">üìÑ Exportar a PDF (Oficio)</button>
        </div>
    </div>

    <script>
        // Configuraci√≥n de fecha y hora actual
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            document.getElementById('fecha').valueAsDate = now;
            document.getElementById('hora').value = now.toTimeString().slice(0,5);
            
            setupSignaturePad();
        });

        // Configurar Canvas para firma
        let signaturePad;
        function setupSignaturePad() {
            const canvas = document.getElementById('signature-pad');
            const ctx = canvas.getContext('2d');
            
            // Ajustar tama√±o del canvas
            canvas.width = canvas.offsetWidth;
            canvas.height = 180;
            
            let drawing = false;
            let lastX = 0;
            let lastY = 0;

            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);

            // Soporte t√°ctil
            canvas.addEventListener('touchstart', handleTouchStart);
            canvas.addEventListener('touchmove', handleTouchMove);
            canvas.addEventListener('touchend', stopDrawing);

            function startDrawing(e) {
                drawing = true;
                const rect = canvas.getBoundingClientRect();
                lastX = e.clientX - rect.left;
                lastY = e.clientY - rect.top;
            }

            function draw(e) {
                if (!drawing) return;
                
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(x, y);
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.stroke();

                lastX = x;
                lastY = y;
            }

            function stopDrawing() {
                drawing = false;
            }

            function handleTouchStart(e) {
                e.preventDefault();
                const touch = e.touches[0];
                const rect = canvas.getBoundingClientRect();
                drawing = true;
                lastX = touch.clientX - rect.left;
                lastY = touch.clientY - rect.top;
            }

            function handleTouchMove(e) {
                e.preventDefault();
                if (!drawing) return;
                
                const touch = e.touches[0];
                const rect = canvas.getBoundingClientRect();
                const x = touch.clientX - rect.left;
                const y = touch.clientY - rect.top;

                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(x, y);
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.stroke();

                lastX = x;
                lastY = y;
            }
        }

        function clearSignature() {
            const canvas = document.getElementById('signature-pad');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function showAlert(message, type) {
            const container = document.getElementById('alert-container');
            container.innerHTML = `<div class="alert alert-${type} show">${message}</div>`;
            
            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }

        function validateForm() {
            // Validar campos obligatorios b√°sicos
            const fecha = document.getElementById('fecha').value;
            const hora = document.getElementById('hora').value;
            const placa = document.getElementById('placa').value;

            if (!fecha || !hora || !placa) {
                showAlert('‚ùå Por favor complete los campos obligatorios: Fecha, Hora y Placa', 'error');
                return false;
            }

            // Validar checkboxes obligatorios
            const checksObligatorios = document.querySelectorAll('.check-obligatorio');
            let todosChecked = true;

            checksObligatorios.forEach(check => {
                if (!check.checked) {
                    todosChecked = false;
                }
            });

            if (!todosChecked) {
                showAlert('‚ùå Debe aceptar todas las condiciones OBLIGATORIAS marcadas en verde', 'error');
                return false;
            }

            // Validar firma
            const canvas = document.getElementById('signature-pad');
            const ctx = canvas.getContext('2d');
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const isEmpty = !imageData.data.some(channel => channel !== 0);

            if (isEmpty) {
                showAlert('‚ùå Por favor firme el documento antes de guardar', 'error');
                return false;
            }

            return true;
        }

        function collectFormData() {
            const data = {
                fecha: document.getElementById('fecha').value,
                hora: document.getElementById('hora').value,
                placa: document.getElementById('placa').value.toUpperCase(),
                visita: document.querySelector('input[name="visita"]:checked').value,
                preparado: document.querySelector('input[name="preparado"]:checked').value,
                marca: document.getElementById('marca').value,
                color: document.getElementById('color').value,
                numSillas: document.getElementById('num-sillas').value,
                clase: document.querySelector('input[name="clase"]:checked').value,
                servicio: document.querySelector('input[name="servicio"]:checked').value,
                combustible: document.querySelector('input[name="combustible"]:checked').value,
                cumple: document.querySelector('input[name="cumple"]:checked').value,
                pruebas: [],
                inspeccion: {},
                condiciones: {
                    obligatorias: [],
                    opcionales: []
                },
                firma: document.getElementById('signature-pad').toDataURL()
            };

            // Recopilar pruebas
            ['alineacion', 'frenos', 'gases', 'suspension', 'luces', 'opacidad'].forEach(prueba => {
                if (document.getElementById(`prueba-${prueba}`).checked) {
                    data.pruebas.push(prueba);
                }
            });

            // Recopilar inspecciones
            for (let i = 1; i <= 15; i++) {
                const selected = document.querySelector(`input[name="insp-${i}"]:checked`);
                if (selected) {
                    data.inspeccion[`item${i}`] = selected.value;
                }
            }

            // Recopilar condiciones
            document.querySelectorAll('.check-obligatorio').forEach((check, index) => {
                data.condiciones.obligatorias.push({
                    id: index + 1,
                    checked: check.checked
                });
            });

            document.querySelectorAll('.check-opcional').forEach((check, index) => {
                data.condiciones.opcionales.push({
                    id: index + 1,
                    checked: check.checked
                });
            });

            return data;
        }

        function saveRecord() {
            if (!validateForm()) {
                return;
            }

            const data = collectFormData();
            
            // Guardar en localStorage
            const registros = JSON.parse(localStorage.getItem('registros-cda') || '[]');
            registros.push({
                ...data,
                timestamp: new Date().toISOString()
            });
            localStorage.setItem('registros-cda', JSON.stringify(registros));

            showAlert('‚úÖ Registro guardado exitosamente', 'success');
        }

        function generatePDF() {
            if (!validateForm()) {
                return;
            }

            // Ocultar botones antes de capturar
            const buttons = document.querySelectorAll('.btn, .firma-buttons');
            buttons.forEach(btn => btn.style.display = 'none');

            const element = document.getElementById('printable-area');
            
            html2canvas(element, {
                scale: 2,
                useCORS: true,
                logging: false,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const { jsPDF } = window.jspdf;
                
                // Tama√±o oficio: 215.9 x 355.6 mm
                const pdf = new jsPDF('p', 'mm', 'legal');
                
                const imgWidth = 215.9;
                const pageHeight = 355.6;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;

                const imgData = canvas.toDataURL('image/png');
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                const placa = document.getElementById('placa').value;
                const fecha = document.getElementById('fecha').value;
                pdf.save(`Recepcion_CDA_${placa}_${fecha}.pdf`);

                // Restaurar botones
                buttons.forEach(btn => btn.style.display = '');
                
                showAlert('‚úÖ PDF generado exitosamente', 'success');
            });
        }

        // Convertir placa a may√∫sculas autom√°ticamente
        document.getElementById('placa').addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase();
        });
    </script>
</body>
</html>
